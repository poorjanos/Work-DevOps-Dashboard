---
title: "DevOps Dashboard BETA"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
```

Volumes
===================================== 

Column 
-------------------------------------

### Open Tickets

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)

t_ticket_open <- read.csv(here::here("Data", "t_ticket_open.csv"), stringsAsFactors = FALSE) %>% 
  filter(COUNT != 0)

p <- ggplot(t_ticket_open, aes(x = CUTPOINT, y = COUNT, group = TICKET)) +
  geom_line(aes(colour = TICKET)) +
  theme(
    axis.text.x = element_text(angle = 90),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )


ggplotly(p, tooltip = c("x", "y", "colour")) %>%
  layout(
    legend = list(orientation = "v", y = 0.5),
    margin = list(b = 100)
  )
```


Column 
-------------------------------------

### Tickets Started

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)

t_ticket_started <- read.csv(here::here("Data", "t_ticket_started.csv"), stringsAsFactors = FALSE) %>% 
  filter(COUNT != 0) 

p <- ggplot(t_ticket_started, aes(x = CREATED_MONTH, y = COUNT, group = TICKET)) +
  geom_line(aes(colour = TICKET)) +
  theme(
    axis.text.x = element_text(angle = 90),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )


ggplotly(p, tooltip = c("x", "y", "colour")) %>%
  layout(
    legend = list(orientation = "v", y = 0.5),
    margin = list(b = 100)
  )
```



### Tickets Closed

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)

t_ticket_closed <- read.csv(here::here("Data", "t_ticket_closed.csv"), stringsAsFactors = FALSE) %>% 
  filter(COUNT != 0)

p <- ggplot(t_ticket_closed, aes(x = CLOSED_MONTH, y = COUNT, group = TICKET)) +
  geom_line(aes(colour = TICKET)) +
  theme(
    axis.text.x = element_text(angle = 90),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )


ggplotly(p, tooltip = c("x", "y", "colour")) %>%
  layout(
    legend = list(orientation = "v", y = 0.5),
    margin = list(b = 100)
  )
```



Lead Times
===================================== 

Column 
-------------------------------------

### Total Median Lead Times

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)

t_leadtime_ticket <- read.csv(here::here("Data", "t_leadtime_ticket.csv"), stringsAsFactors = FALSE)

p <- ggplot(t_leadtime_ticket, aes(x = CLOSED_MONTH, y = LEADTIME, group = TICKET)) +
  geom_line(aes(colour = TICKET)) +
  theme(
    axis.text.x = element_text(angle = 90),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )


ggplotly(p, tooltip = c("x", "y", "colour")) %>%
  layout(
    legend = list(orientation = "v", y = 0.5),
    margin = list(b = 100)
  )
```


Column 
-------------------------------------

### Development Net Lead Times (Corrected for Voting Times)

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)

t_leadtime_dev_net <- read.csv(here::here("Data", "t_leadtime_dev_net.csv"), stringsAsFactors = FALSE)

p <- ggplot(t_leadtime_dev_net, aes(x = CLOSED_MONTH, y = LEADTIME_NET, group = TICKET)) +
  geom_line(aes(colour = TICKET)) +
  theme(
    axis.text.x = element_text(angle = 90),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )


ggplotly(p, tooltip = c("x", "y", "colour")) %>%
  layout(
    legend = list(orientation = "v", y = 0.5),
    margin = list(b = 100)
  )
```



### Ratio of Lead Time Spent on Voting

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(scales)
library(plotly)

t_leadtime_dev_net <- read.csv(here::here("Data", "t_leadtime_dev_net.csv"), stringsAsFactors = FALSE)

p <- ggplot(t_leadtime_dev_net, aes(x = CLOSED_MONTH, y = VOTING_RATIO, group = TICKET)) +
  geom_line(aes(colour = TICKET)) +
  scale_y_continuous(labels = percent) +
  theme(
    axis.text.x = element_text(angle = 90),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )


ggplotly(p, tooltip = c("x", "y", "colour")) %>%
  layout(
    yaxis = list(hoverformat = '.4f'),
    legend = list(orientation = "v", y = 0.5),
    margin = list(b = 100)
  )
```